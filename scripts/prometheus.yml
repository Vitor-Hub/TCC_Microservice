global:
  scrape_interval: 5s
  evaluation_interval: 5s

scrape_configs:
  # ======================
  # Gateway principal (porta 8765)
  # ======================
  - job_name: "gateway"
    metrics_path: /actuator/prometheus
    static_configs:
      - targets: ["host.docker.internal:8765"]
        labels:
          app: "gateway"

  # ======================
  # Microsserviços acessíveis via Gateway
  # (cada um expõe /actuator/prometheus através de seu prefixo)
  # ======================
  - job_name: "microservices"
    metrics_path: /user-ms/actuator/prometheus
    static_configs:
      - targets: ["host.docker.internal:8765"]
        labels:
          app: "user-ms"

  - job_name: "post-ms"
    metrics_path: /post-ms/actuator/prometheus
    static_configs:
      - targets: ["host.docker.internal:8765"]
        labels:
          app: "post-ms"

  - job_name: "like-ms"
    metrics_path: /like-ms/actuator/prometheus
    static_configs:
      - targets: ["host.docker.internal:8765"]
        labels:
          app: "like-ms"

  - job_name: "friendship-ms"
    metrics_path: /friendship-ms/actuator/prometheus
    static_configs:
      - targets: ["host.docker.internal:8765"]
        labels:
          app: "friendship-ms"

  - job_name: "comment-ms"
    metrics_path: /comment-ms/actuator/prometheus
    static_configs:
      - targets: ["host.docker.internal:8765"]
        labels:
          app: "comment-ms"

  # ======================
  # Infraestrutura
  # ======================
  - job_name: "node"
    static_configs:
      - targets: ["node-exporter:9100"]

  - job_name: "cadvisor"
    static_configs:
      - targets: ["cadvisor:8080"]

  - job_name: "k6"
    static_configs:
      - targets: ["host.docker.internal:9464"]
